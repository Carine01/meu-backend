name: Agent Reviewer - request reviewers & comment

on:
  pull_request:
    types: [opened, reopened, synchronize, labeled]

permissions:
  pull-requests: write
  contents: read

jobs:
  request-review:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Add PR checklist comment
        uses: peter-evans/create-or-update-comment@v4
        with:
          issue-number: ${{ github.event.pull_request.number }}
          body: |
            ğŸ” **Checklist AutomÃ¡tico de RevisÃ£o**
            - [ ] TypeScript Guardian (build+tests) âœ…
            - [ ] Quality Gate (sem console.log / secrets) âœ…
            - [ ] register-fallback aplicado (quando aplicÃ¡vel) âœ…
            - [ ] Docker build ok (quando aplicÃ¡vel) âœ…
            - [ ] RevisÃ£o humana (1 aprovador) âœ…

            _Se algum item falhar, por favor adicione comentÃ¡rio com evidÃªncias e reprovaÃ§Ã£o parcial._

      - name: Request reviewers if label present
        if: contains(github.event.pull_request.labels.*.name, 'needs-review')
        uses: dawidd6/action-request-review@v1
        with:
          reviewers: |
            devuser1,devuser2
          team-reviewers: |
            # optionally: team-slug
